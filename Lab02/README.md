`Дисциплина: Методы и технологии машинного обучения`   
`Уровень подготовки: бакалавриат`   
`Направление подготовки: 01.03.02 Прикладная математика и информатика`   
`Семестр: осень 2021/2022`   

**Выполнил студент ПМИ3-1 Поталайнен Илья**

**Вариант: 15**

# Лабораторная работа №2: Линейные модели. Кросс-валидация

*Данные*: `College_for_lab` (источник: <https://github.com/aksyuk/MTML/blob/main/Labs/data/College_for_lab.csv>)

### Зависимая и объясняющие переменные

* Зависимая: `Grad_Rate` — выпускной балл.
* Объясняющие:
    + `Top25perc` — процент зачисленных студентов, которые в старшей школе относились к топ-25% в диапазоне по освоению; 
    + `F_Undergrad` —  количество студенческой формы обучения; 
    + `Private` — частный или государственный университет: 
        - Да - частный, 
        - Нет - государственный.

1. Данные своего варианта (см. таблицу ниже) разделить на выборку для построения моделей (80%) и отложенные наблюдения (20%). Оставить в таблице только указанные в варианте переменные. Отложенные наблюдения использовать только в задании 6.
2. Провести предварительный анализ данных с помощью описательных статистик и графиков, оценить взаимосвязь.
3. Проверить Y на нормальность. Если он распределён не по нормальному закону, прологарифмировать и снова провести анализ взаимосвязей переменных.
4. Составить список возможных спецификаций моделей множественной регрессии (на исходной Y и на логарифме Y ).
5. Оценить параметры моделей из списка. Оценить точность моделей методом перекрёстной проверки, указанным в варианте. Найти самую точную из моделей для Y . Найти самую точную из моделей для log(Y).
6. Сделать прогноз с помощью самых точных моделей на отложенные наблюдения. Рассчитать MSEtest вручную и выбрать одну наиболее точную модель. Проинтерпретировать её параметры.

Задание 1.
Загружены все необходимые для работы модули, определены константы и загружены входные данные. Во входных данных отфильтрованы только необходимые для работы признаки. Определена фиктивная переменная для качественного признака и объединена с исходными данными. Исходная выборка разделена на тренировочную и тестовую.

Задание 2.
<ul>
    <li>Построены гистограммы распределения и графики зависимости количественных переменных;</li>
    <li>Построены гистограммы распределения и графики зависимости количественных переменных для разных значений качественной переменной;</li>
    <li>Построены матрицы корреляции количественных переменных;</li>
    <li>Построены матрицу корреляции количественных переменных для разных значений качественной переменной.</li>
</ul>

### Интерпретация результатов визуального анализа
* распределение зависимой переменной `Grad_Rate` приближено к нормальному;
* распределение независимой переменной `Top25perc` приближено к нормальному;
* распределение независимой переменной `F_Undergrad` не приближено к нормальному;
* с ростом независимой переменной `Top25perc` наблюдается рост зависимой `Grad_Rate`, что свидетельствует о наличии средней положительной корреляции между этими факторами;
* на диаграммах разброса `F_Undergrad` vs `Grad_Rate` и `F_Undergrad` vs `Top25perc` присутствуют наблюдения, группирующиеся на удалении от основного набора данных; данные наблюдения могут исказить параметры модели и привести к неверным статистическим выводам.

### Интерпретация графиков разброса по категориям `Private`
Оранжевые и синие точки визуально распределены равномерно. Оранжевые точки смещены влево по `F_Undergrad`, поскольку частные университеты являются более специализированными, то есть имеют меньшее число форм обучения, нежели государственные. В остальном явных тенденций не обнаружено.

Задание 3.
Проверено распределение переменной `Grad_Rate` и ее логарифма на нормальность посредством теста Джарка-Бера. Оказалось, что распределение переменной `Grad_Rate` является нормальным, в логарифмировании нет смысла.

Задание 4.
В соответствии с результатами задания 2 можно составить следующие линейные спецификации модели:
<ol>
    <li>$GradRate = Private + Top25perc + FUndergrad$</li>
    <li>$GradRate = Private + Top25perc \times Private + FUndergrad$</li>
    <li>$GradRate = Private + Top25perc + FUndergrad \times Private$</li>
    <li>$GradRate = Private + Top25perc \times Private + FUndergrad \times Private$</li>
</ol>
Задание 5.
Построены модели, определенные в задании 4. Оценена точность моделей методом перекрёстной проверки K-VAL. Найдена самая точная модель. Определено, что наименьшую ошибку перекрёстной проверки выдает модель $GradRate = Private + Top25perc + FUndergrad$ на исходных данных и модель $GradRate = Private + Top25perc \times Private + FUndergrad \times Private$ на очищенных.

Задание 6.
Сделан прогноз на отложенных наблюдениях. Оценена точность прогноза по этим моделям на отложенных наблюдениях. Ошибка модели на отложенных наблюдениях составила 2.9% от среднего значения $Y$. Лучшей моделью оказалась: $GradRate = 15,387Private + 0,3751Top25perc + 0,0003FUndergrad$

Параметры можно интерпретировать следующим образом:

1. У студентов из частных университетов выпускные баллы в среднем на $15,387$ выше, чем у студентов из государственных.
2. При увеличении на единицу процента зачисленных студентов, которые в старшей школе относились к топ-25% в диапазоне по освоению (`Top25perc`), выпускной балл увеличится в среднем на $0,3751$.
3. При увеличении числа форм обучения (`F_Undergrad`) на единицу, выпуксной балл увеличится в среднем на $0,0003$.
